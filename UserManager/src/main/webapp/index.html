<!DOCTYPE html>
<html lang='en'>
    <head>
        <title>Manage Users</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" type="text/css"/>
        <script src="js/require/require.js" data-main="js/main"></script>
    </head>
    <body>    
        <div class="container">    
            <h2>User Manager</h2>
            <hr/>
            <a href="#/new" class="btn btn-primary">Add User</a>
            <hr/>
            <div class="page"></div>
        </div>
                       
        <script>
//            $.ajaxPrefilter(function(options, originalOptions, jqXHR) {
//                options.url = 'http://localhost:8080/helloREST/v1/manager' + options.url;
//            });
//            
//            
            
//            var Users = Backbone.Collection.extend({
//                url: '/users'
//            });
//            
//            var User = Backbone.Model.extend({
//                urlRoot: '/users'
//            });
//            
//            var UserList = Backbone.View.extend({
//                el: '.page',
//                render: function () {
//                    var that = this;
//                    var users = new Users();
//                    users.fetch({
//                        success: function(users) {
//                            var template = _.template($("#user-list-template").html(), {users: users.models});
//                            that.$el.html(template);
//                        }
//                    });                    
//                }
//            });
//            
//            var EditUser = Backbone.View.extend({                
//                el: '.page',
//                render: function (options) {   
//                    var that = this;
//                    if (options.id) {
//                        that.user = new User({id: options.id});                        
//                        that.user.fetch({
//                            success: function (user) {
//                                var template = _.template($("#edit-user-template").html(), {user: user});
//                                that.$el.html(template);
//                            }
//                        });
//                    }else{
//                        var template = _.template($("#edit-user-template").html(), {user: null});
//                        this.$el.html(template);
//                    }                    
//                },
//                events: {
//                    'submit .edit-user-form': 'saveUser',  
//                    'click .delete': 'deleteUser'
//                },
//                saveUser: function (ev) {
//                    var userDetails = $(ev.currentTarget).serializeObject();
//                    var user = new User();
//                    user.save(userDetails, {
//                        success: function () {
//                            router.navigate('', {trigger: true});
//                        }
//                    });
//                    return false;
//                },
//                deleteUser: function (ev) {                    
//                    this.user.destroy({
//                        success: function () {
//                            router.navigate('', {trigger: true});
//                        }
//                    })
//                    return false;
//                }
//            });
//            
//            var Router = Backbone.Router.extend({
//                routes: {
//                    '': 'home',
//                    'new': 'editUser',
//                    'edit/:id': 'editUser'
//                }
//            });
//            
//            var editUser = new EditUser();
//            var userList = new UserList();
//            var router = new Router();
//            
//            router.on('route:editUser', function (id) {
//               editUser.render({id: id});
//            });
//            router.on('route:home', function () {
//               userList.render();
//            });
//            
//            Backbone.history.start();
        </script>
    </body>
</html>